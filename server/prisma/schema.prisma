generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Booking {
  id                 Int       @id @default(autoincrement())
  mentor_id          String
  student_id         String
  student_name       String?
  start_time         DateTime
  end_time           DateTime
  duration_hours     Int       @default(1)
  summary            String?
  description        String?
  status             String    @default("pending")
  meet_link          String?
  mentor_response_at DateTime?
  rejection_reason   String?
  created_at         DateTime  @default(now())

  @@index([mentor_id])
  @@index([student_id])
  @@index([status])
  @@map("bookings")
}

model Review {
  id          Int      @id @default(autoincrement())
  mentor_id   String
  author_id   String?
  author_name String
  rating      Int
  text        String?
  created_at  DateTime @default(now())

  @@index([mentor_id])
  @@map("reviews")
}

model Conversation {
  id         Int       @id @default(autoincrement())
  mentor_id  String
  student_id String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  messages   Message[]

  @@unique([mentor_id, student_id])
  @@index([mentor_id])
  @@index([student_id])
  @@map("conversations")
}

model Message {
  id              Int          @id @default(autoincrement())
  conversation_id Int
  sender_id       String
  text            String
  created_at      DateTime     @default(now())
  is_read         Boolean      @default(false)
  conversation    Conversation @relation(fields: [conversation_id], references: [id])

  @@index([conversation_id])
  @@map("messages")
}
